{% extends "base.html" %}

{% block content %}
    <h2>{{ titulo }}</h2>
    
    <form method="POST">
        
        <div>
            <label for="Usuario_id">Usuário *</label>
            <select id="Usuario_id" name="Usuario_id" required>
                <option value="">-- Selecione um Usuário --</option>
                {% for usuario in usuarios %}
                    <option value="{{ usuario.ID_usuario }}" 
                            {% if emprestimo and emprestimo.Usuario_id == usuario.ID_usuario %}selected{% endif %}>
                        {{ usuario.Nome_usuario }}
                    </option>
                {% endfor %}
            </select>
        </div>
        
        <div>
            <label for="Livro_id">Livro *</label>
            <select id="Livro_id" name="Livro_id" required>
                <option value="">-- Selecione um Livro --</option>
                {% for livro in livros %}
                    <option value="{{ livro.ID_livro }}"
                            {% if emprestimo and emprestimo.Livro_id == livro.ID_livro %}selected{% endif %}>
                        {{ livro.Titulo }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div>
            <label for="Data_emprestimo">Data do Empréstimo *</label>
            <input type="date" id="Data_emprestimo" name="Data_emprestimo" required
                   value="{{ emprestimo.Data_emprestimo.strftime('%Y-%m-%d') if emprestimo and emprestimo.Data_emprestimo else '' }}">
        </div>
        
        <div>
            <label for="Data_devolucao_prevista">Devolução Prevista *</label>
            <input type="date" id="Data_devolucao_prevista" name="Data_devolucao_prevista" required
                   value="{{ emprestimo.Data_devolucao_prevista.strftime('%Y-%m-%d') if emprestimo and emprestimo.Data_devolucao_prevista else '' }}">
        </div>

        <div>
            <label for="Data_devolucao_real">Devolução Real (se houver)</label>
            <input type="date" id="Data_devolucao_real" name="Data_devolucao_real"
                   value="{{ emprestimo.Data_devolucao_real.strftime('%Y-%m-%d') if emprestimo and emprestimo.Data_devolucao_real else '' }}">
        </div>

        <div>
            <label for="Status_emprestimo">Status *</label>
            <select id="Status_emprestimo" name="Status_emprestimo" required>
                {% set status_selecionado = emprestimo.Status_emprestimo if emprestimo else 'pendente' %}
                <option value="pendente" {% if status_selecionado == 'pendente' %}selected{% endif %}>Pendente</option>
                <option value="devolvido" {% if status_selecionado == 'devolvido' %}selected{% endif %}>Devolvido</option>
                <option value="atrasado" {% if status_selecionado == 'atrasado' %}selected{% endif %}>Atrasado</option>
            </select>
        </div>
        
        <div>
            <button type="submit">Salvar</button>
        </div>
    </form>
{% endblock %}